!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("rxjs/Subject"),require("rxjs/add/operator/debounceTime")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/common","rxjs/Subject","rxjs/add/operator/debounceTime"],t):t(e["angular-split"]=e["angular-split"]||{},e.ng.core,e.ng.common,e.Rx)}(this,function(e,t,i,n){"use strict";var r=function(){function e(e,i,r){this.cdRef=e,this.elementRef=i,this.renderer=r,this.direction="horizontal",this.gutterSize=10,this.disabled=!1,this.visibleTransition=!1,this.dragStart=new t.EventEmitter(!1),this.dragProgress=new t.EventEmitter(!1),this.dragEnd=new t.EventEmitter(!1),this.visibleTransitionEndInternal=new n.Subject,this.visibleTransitionEnd=this.visibleTransitionEndInternal.asObservable().debounceTime(20),this.areas=[],this.minPercent=5,this.isDragging=!1,this.containerSize=0,this.areaASize=0,this.areaBSize=0,this.eventsDragFct=[]}return Object.defineProperty(e.prototype,"styleFlexDirection",{get:function(){return"vertical"===this.direction},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"styleFlexDirectionStyle",{get:function(){return"horizontal"===this.direction?"row":"column"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragging",{get:function(){return!this.visibleTransition||this.isDragging},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"styleWidth",{get:function(){return this.width&&!isNaN(this.width)&&this.width>0?this.width+"px":"100%"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"styleHeight",{get:function(){return this.height&&!isNaN(this.height)&&this.height>0?this.height+"px":"100%"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visibleAreas",{get:function(){return this.areas.filter(function(e){return e.component.visible})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nbGutters",{get:function(){return this.visibleAreas.length-1},enumerable:!0,configurable:!0}),e.prototype.ngOnChanges=function(e){(e.gutterSize||e.disabled)&&this.refresh()},e.prototype.addArea=function(e,t,i,n){this.areas.push({component:e,orderUser:t,order:-1,sizeUser:i,size:-1,minPixel:n}),this.refresh()},e.prototype.updateArea=function(e,t,i,n){var r=this.areas.find(function(t){return t.component===e});r&&(r.orderUser=t,r.sizeUser=i,r.minPixel=n,this.refresh())},e.prototype.removeArea=function(e){var t=this.areas.find(function(t){return t.component===e});if(t){var i=this.areas.indexOf(t);this.areas.splice(i,1),this.areas.forEach(function(e,t){return e.order=2*t}),this.refresh()}},e.prototype.hideArea=function(e){this.areas.find(function(t){return t.component===e})&&this.refresh()},e.prototype.showArea=function(e){this.areas.find(function(t){return t.component===e})&&this.refresh()},e.prototype.isLastVisibleArea=function(e){var t=this.visibleAreas;return t.length>0&&e===t[t.length-1]},e.prototype.refresh=function(){var e=this;this.stopDragging();var t=this.visibleAreas;this.areas.filter(function(e){return null!==e.orderUser&&!isNaN(e.orderUser)}).length===this.areas.length&&this.areas.sort(function(e,t){return+e.orderUser-+t.orderUser}),this.areas.forEach(function(e,t){e.order=2*t,e.component.setStyle("order",e.order)});var i=t.map(function(e){return e.sizeUser}).reduce(function(e,t){return e+t},0),n=t.filter(function(t){return null!==t.sizeUser&&!isNaN(t.sizeUser)&&t.sizeUser>=e.minPercent}).length;if(i<99.99||i>100.01||n!==t.length){var r=Number((100/t.length).toFixed(3));t.forEach(function(e){return e.size=r})}else t.forEach(function(e){return e.size=Number(e.sizeUser)});this.refreshStyleSizes(),this.cdRef.markForCheck()},e.prototype.refreshStyleSizes=function(){var e=this.visibleAreas,t=this.gutterSize*this.nbGutters/e.length;e.forEach(function(e){return e.component.setStyle("flex-basis","calc( "+e.size+"% - "+t+"px )")})},e.prototype.startDragging=function(e,t){var i=this;if(e.preventDefault(),!this.disabled){var n=this.areas.find(function(e){return e.order===t-1}),r=this.areas.find(function(e){return e.order===t+1});if(n&&r){var s="horizontal"===this.direction?"offsetWidth":"offsetHeight";this.containerSize=this.elementRef.nativeElement[s],this.areaASize=this.containerSize*n.size/100,this.areaBSize=this.containerSize*r.size/100;var o;if(e instanceof MouseEvent)o={x:e.screenX,y:e.screenY};else{if(!(e instanceof TouchEvent))return;o={x:e.touches[0].screenX,y:e.touches[0].screenY}}this.eventsDragFct.push(this.renderer.listenGlobal("document","mousemove",function(e){return i.dragEvent(e,o,n,r)})),this.eventsDragFct.push(this.renderer.listenGlobal("document","touchmove",function(e){return i.dragEvent(e,o,n,r)})),this.eventsDragFct.push(this.renderer.listenGlobal("document","mouseup",function(e){return i.stopDragging()})),this.eventsDragFct.push(this.renderer.listenGlobal("document","touchend",function(e){return i.stopDragging()})),this.eventsDragFct.push(this.renderer.listenGlobal("document","touchcancel",function(e){return i.stopDragging()})),n.component.lockEvents(),r.component.lockEvents(),this.isDragging=!0,this.notify("start")}}},e.prototype.dragEvent=function(e,t,i,n){if(this.isDragging){var r;if(e instanceof MouseEvent)r={x:e.screenX,y:e.screenY};else{if(!(e instanceof TouchEvent))return;r={x:e.touches[0].screenX,y:e.touches[0].screenY}}this.drag(t,r,i,n)}},e.prototype.drag=function(e,t,i,n){var r="horizontal"===this.direction?e.x-t.x:e.y-t.y,s=this.areaASize-r,o=this.areaBSize+r;if(!(s<=i.minPixel&&o<n.minPixel)){var a=s/this.containerSize*100,l=o/this.containerSize*100;a<=this.minPercent?(a=this.minPercent,l=i.size+n.size-this.minPercent):l<=this.minPercent?(l=this.minPercent,a=i.size+n.size-this.minPercent):(a=Number(a.toFixed(3)),l=Number((i.size+n.size-a).toFixed(3))),i.size=a,n.size=l,this.refreshStyleSizes(),this.notify("progress")}},e.prototype.stopDragging=function(){if(this.isDragging){for(this.areas.forEach(function(e){return e.component.unlockEvents()});this.eventsDragFct.length>0;){var e=this.eventsDragFct.pop();e&&e()}this.containerSize=0,this.areaASize=0,this.areaBSize=0,this.isDragging=!1,this.notify("end")}},e.prototype.notify=function(e){var t=this.visibleAreas.map(function(e){return e.size});switch(e){case"start":return this.dragStart.emit(t);case"progress":return this.dragProgress.emit(t);case"end":return this.dragEnd.emit(t);case"visibleTransitionEnd":return this.visibleTransitionEndInternal.next(t)}},e.prototype.ngOnDestroy=function(){this.stopDragging()},e.decorators=[{type:t.Component,args:[{selector:"split",changeDetection:t.ChangeDetectionStrategy.OnPush,styles:["\n        :host {\n            display: flex;\n            flex-wrap: nowrap;\n            justify-content: flex-start;\n            align-items: stretch;\n            flex-direction: row;\n        }\n\n        :host.vertical {\n            flex-direction: column;\n        }\n\n        split-gutter {\n            flex-grow: 0;\n            flex-shrink: 0;\n            background-color: #eeeeee;\n            background-position: center center;\n            background-repeat: no-repeat;\n        }\n\n        :host.vertical split-gutter {\n            width: 100%;\n        }\n\n        :host /deep/ split-area {\n            transition: flex-basis 0.3s;\n        }  \n\n        :host.notransition /deep/ split-area {\n            transition: none !important;\n        }      \n\n        :host /deep/ split-area.hided {\n            flex-basis: 0 !important;\n            overflow: hidden !important;\n        }      \n\n        :host.vertical /deep/ split-area.hided {\n            max-width: 0;\n        }\n    "],template:'\n        <ng-content></ng-content>\n        <ng-template ngFor let-area [ngForOf]="areas" let-index="index" let-last="last">\n            <split-gutter *ngIf="last === false && area.component.visible === true && !isLastVisibleArea(area)" \n                          [order]="index*2+1"\n                          [direction]="direction"\n                          [size]="gutterSize"\n                          [disabled]="disabled"\n                          (mousedown)="startDragging($event, index*2+1)"\n                          (touchstart)="startDragging($event, index*2+1)"></split-gutter>\n        </ng-template>'}]}],e.ctorParameters=function(){return[{type:t.ChangeDetectorRef},{type:t.ElementRef},{type:t.Renderer}]},e.propDecorators={direction:[{type:t.Input}],width:[{type:t.Input}],height:[{type:t.Input}],gutterSize:[{type:t.Input}],disabled:[{type:t.Input}],visibleTransition:[{type:t.Input}],dragStart:[{type:t.Output}],dragProgress:[{type:t.Output}],dragEnd:[{type:t.Output}],visibleTransitionEnd:[{type:t.Output}],styleFlexDirection:[{type:t.HostBinding,args:["class.vertical"]}],styleFlexDirectionStyle:[{type:t.HostBinding,args:["style.flex-direction"]}],dragging:[{type:t.HostBinding,args:["class.notransition"]}],styleWidth:[{type:t.HostBinding,args:["style.width"]}],styleHeight:[{type:t.HostBinding,args:["style.height"]}]},e}(),s=function(){function e(e,t,i){this.elementRef=e,this.renderer=t,this.split=i,this._order=null,this._size=null,this._minSizePixel=0,this._visible=!0,this.visibility="block",this.eventsLockFct=[]}return Object.defineProperty(e.prototype,"order",{set:function(e){this._order=isNaN(e)?null:e,this.split.updateArea(this,this._order,this._size,this._minSizePixel)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{set:function(e){this._size=isNaN(e)?null:e,this.split.updateArea(this,this._order,this._size,this._minSizePixel)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minSizePixel",{set:function(e){this._minSizePixel=!isNaN(e)&&e>0?e:0,this.split.updateArea(this,this._order,this._size,this._minSizePixel)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},set:function(e){this.visibility=e?"block":"none",this._visible=e,this.visible?this.split.showArea(this):this.split.hideArea(this)},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){this.split.addArea(this,this._order,this._size,this._minSizePixel)},e.prototype.lockEvents=function(){this.eventsLockFct.push(this.renderer.listen(this.elementRef.nativeElement,"selectstart",function(e){return!1})),this.eventsLockFct.push(this.renderer.listen(this.elementRef.nativeElement,"dragstart",function(e){return!1}))},e.prototype.unlockEvents=function(){for(;this.eventsLockFct.length>0;){var e=this.eventsLockFct.pop();e&&e()}},e.prototype.setStyle=function(e,t){this.renderer.setElementStyle(this.elementRef.nativeElement,e,t)},e.prototype.ngOnDestroy=function(){this.split.removeArea(this)},e.prototype.onTransitionEnd=function(e){"flex-basis"===e.propertyName&&this.split.notify("visibleTransitionEnd")},e.decorators=[{type:t.Directive,args:[{selector:"split-area",host:{"[style.flex-grow]":'"0"',"[style.flex-shrink]":'"0"',"[style.overflow-x]":'"hidden"',"[style.overflow-y]":'"auto"',"[style.height]":'"100%"',"[class.hided]":"!visible","(transitionend)":"onTransitionEnd($event)"}}]}],e.ctorParameters=function(){return[{type:t.ElementRef},{type:t.Renderer},{type:r}]},e.propDecorators={order:[{type:t.Input}],size:[{type:t.Input}],minSizePixel:[{type:t.Input}],visible:[{type:t.Input}]},e}(),o=function(){function e(e,t){this.elementRef=e,this.renderer=t,this._disabled=!1}return Object.defineProperty(e.prototype,"order",{set:function(e){this.setStyle("order",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"direction",{set:function(e){this._direction=e,this.refreshStyle()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{set:function(e){this._size=e,this.refreshStyle()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{set:function(e){this._disabled=e,this.refreshStyle()},enumerable:!0,configurable:!0}),e.prototype.refreshStyle=function(){this.setStyle("flex-basis",this._size+"px"),this.setStyle("height","vertical"===this._direction?this._size+"px":"100%");var e=!0===this._disabled?"disabled":this._direction;this.setStyle("cursor",this.getCursor(e)),this.setStyle("background-image",'url("'+this.getImage(e)+'")')},e.prototype.setStyle=function(e,t){this.renderer.setElementStyle(this.elementRef.nativeElement,e,t)},e.prototype.getCursor=function(e){switch(e){case"disabled":return"default";case"vertical":return"row-resize";case"horizontal":return"col-resize"}},e.prototype.getImage=function(e){switch(e){case"disabled":return"";case"vertical":return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAFCAMAAABl/6zIAAAABlBMVEUAAADMzMzIT8AyAAAAAXRSTlMAQObYZgAAABRJREFUeAFjYGRkwIMJSeMHlBkOABP7AEGzSuPKAAAAAElFTkSuQmCC";case"horizontal":return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg=="}},e.decorators=[{type:t.Directive,args:[{selector:"split-gutter"}]}],e.ctorParameters=function(){return[{type:t.ElementRef},{type:t.Renderer}]},e.propDecorators={order:[{type:t.Input}],direction:[{type:t.Input}],size:[{type:t.Input}],disabled:[{type:t.Input}]},e}(),a=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[i.CommonModule],declarations:[r,s,o],exports:[r,s,o]}]}],e.ctorParameters=function(){return[]},e}();e.AngularSplitModule=a,e.SplitComponent=r,e.SplitAreaDirective=s,e.SplitGutterDirective=o,Object.defineProperty(e,"__esModule",{value:!0})});